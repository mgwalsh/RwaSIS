---
title: Workflows for mapping cropping systems using staple food indicator species
author: M.G Walsh, R. Manners, R. Rodríguez Iglesias, J. Meliyo, J. Rutembuka, and B.A Walsh
date: "`r format(Sys.time(), '%d, %B, %Y')`"
output:
  html_document:
    toc: true
    toc_depth: 2
    fig_caption: true
    css: style.css
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(message = FALSE)
```

# Introduction

The term ["Agroecology"](https://www.agroecologyfund.org/what-is-agroecology) refers to farming that “centers on food production that makes the best use of nature’s goods and services while not damaging those resources.” Agroecological practices are closely linked to near-real-time knowledge about the crop (and livestock) combinations, crop sequences and management techniques i.e., ["Cropping systems"](https://www.sciencedirect.com/topics/agricultural-and-biological-sciences/cropping-system) that are applied on a given field, farm or region over a period of years. 

The prevailing cropping systems in East Africa often stand in stark contrast to industrial agricultural practices that rely on reduced labor through mechanization, consolidation of farms and fields, and increased external agricultural inputs such as fossil fuels, electricity, irrigation, GMOs, improved / patented seed, chemical fertilizers, lime, pesticides and herbicides. The increased reliance on external inputs in turn usually comes at economic, health / nutritional, environmental and/or [Ecosystem service](https://en.wikipedia.org/wiki/Ecosystem_service) costs to smallholder farmers and rural communities. It is not possible to gauge or manage the ensuing agroecological interactions and complexities without knowing where specific cropping systems are located and how they may be evolving. As to whether agroecological management actually outperforms industrial agricultural practices in the long-term is an open question that is not supported by adequate data and evidence. We set some cropping systems baselines here to start testing this contention.

*The objective of this notebook is to provide starter code in [R](https://www.r-project.org/) for classifying and delineating of [Staple food](https://en.wikipedia.org/wiki/Staple_food) cropping systems in Rwanda and Tanzania. The data include georeferenced observations of the occurrence of: maize, millet, wheat, sorghum, rice, bean, chickpea, pigeon pea, soybean, Irish potatoes, sweet potatoes, cassava and banana, in addition to livestock as well as the combined presence/absence of numerous other more localized food, oil, beverage and fiber crops. The markdown notebook presented here is maintained on [Github](), and you can fork and alter it from there for your reference, and as you see fit.*

# General data setup

The data we will be using were generated by the [TanSIS]() and [RwaSIS]() projects located in Tanzania and Rwanda respectively. They consist of 17,748 georeferenced, time stamped,and ground photo tagged, field survey observations of staple crops that have been observed in 1 ha circular plots (~56.42 m radius), in proportion to their national occurrence. The spatially representative cropland sampling frames that are used in these ongoing survey data collections are described in [Walsh et al., (2021)](). A field data collection framework (CropScout) has also been posted on [KoboToolbox](https://kobo.humanitarianresponse.info/#/forms/a3jwzkBTtDvdaZJgR6YjAe/), which you can either use directly or modify for your own use with Open Data Kit ([ODK](https://opendatakit.org/)).

## Initial packages and data download

To actually run this notebook, you will need to load the packages indicated in the chunk directly below to download and assemble the data. The chunk (not shown but in the markdown document) also generates an overview map of where the observations were collected in Tanzania and Rwanda ... you can click and zoom into the individual locations. You can find all of the documentation of these packages on [CRAN](https://cran.r-project.org/).

```{r}
# Package names
packages <- c("osfr", "leaflet", "htmlwidgets", "DT", "stargazer", "caret", "caretEnsemble", "mgcv", "MASS", "randomForest", "xgboost", "klaR", "nnet", "dplyr", "doParallel")

# Install packages
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Load packages
invisible(lapply(packages, library, character.only = TRUE))
```

Note that additional, more specialized, package installs will be needed in later sections of this notebook. We shall deal with those as they arise.

## Data downloads

